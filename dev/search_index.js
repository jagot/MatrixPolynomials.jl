var documenterSearchIndex = {"docs":
[{"location":"phi_functions/#φₖ-functions-1","page":"φₖ functions","title":"φₖ functions","text":"","category":"section"},{"location":"phi_functions/#Definition-1","page":"φₖ functions","title":"Definition","text":"","category":"section"},{"location":"phi_functions/#","page":"φₖ functions","title":"φₖ functions","text":"These are defined recursively through","category":"page"},{"location":"phi_functions/#","page":"φₖ functions","title":"φₖ functions","text":"beginequation\nvarphi_0(z) defd ce^z quad\nvarphi_1(z) defd fracce^z-1z quad\nvarphi_k+1(z) defd fracvarphi_k(z)-varphi_k(0)z quad\nvarphi_k(0)=frac1k\nendequation","category":"page"},{"location":"phi_functions/#","page":"φₖ functions","title":"φₖ functions","text":"An alternate definition is","category":"page"},{"location":"phi_functions/#","page":"φₖ functions","title":"φₖ functions","text":"beginequation\nh^k varphi_k(hz) = int_0^h diffs\nce^(h-s)z fracs^k-1(k-1)\nendequation","category":"page"},{"location":"phi_functions/#Accuracy-1","page":"φₖ functions","title":"Accuracy","text":"","category":"section"},{"location":"phi_functions/#Accuracy-for-k1-1","page":"φₖ functions","title":"Accuracy for k=1","text":"","category":"section"},{"location":"phi_functions/#","page":"φₖ functions","title":"φₖ functions","text":"beginequation\nlabeleqnphi-1-naive\nvarphi_1(z) equiv fracce^z-1z\nendequation","category":"page"},{"location":"phi_functions/#","page":"φₖ functions","title":"φₖ functions","text":"This is a common example of catastrophic cancellation; for small absz, ce^z - 1approx 0, and we thus divide a small number by a small number. By employing a trick shown by e.g.","category":"page"},{"location":"phi_functions/#","page":"φₖ functions","title":"φₖ functions","text":"Higham, N. (2002). Accuracy and stability of numerical\nalgorithms. Philadelphia: Society for Industrial and Applied\nMathematics.","category":"page"},{"location":"phi_functions/#","page":"φₖ functions","title":"φₖ functions","text":"we can substantially improve accuracy:","category":"page"},{"location":"phi_functions/#","page":"φₖ functions","title":"φₖ functions","text":"beginequation\nlabeleqnphi-1-accurate\nvarphi_1(z) = begincases\n1  absz  varepsilon\nfracce^z-1logce^z  varepsilon  absz  1 \nfracce^z-1z  textrmelse\nendcases\nendequation","category":"page"},{"location":"phi_functions/#","page":"φₖ functions","title":"φₖ functions","text":"(Image: Illustration of φ₁ accuracy)","category":"page"},{"location":"phi_functions/#","page":"φₖ functions","title":"φₖ functions","text":"The solid line corresponds to the naïve implementation eqrefeqnphi-1-naive, whereas the dashed line corresponds to the accurate implementation eqrefeqnphi-1-accurate.","category":"page"},{"location":"phi_functions/#Accuracy-for-k-1-1","page":"φₖ functions","title":"Accuracy for k  1","text":"","category":"section"},{"location":"phi_functions/#","page":"φₖ functions","title":"φₖ functions","text":"For a Taylor expansion of a function f(x), we have","category":"page"},{"location":"phi_functions/#","page":"φₖ functions","title":"φₖ functions","text":"beginequation\nf(x-a) = underbracesum_i=0^n fracf^(i)(a)i (x-a)^i_defd T_n(x) +\nunderbracefracf^(n+1)(xi)(n+1)(x-a)^n+1_defd R_n(x) quad\nxi in ax\nendequation","category":"page"},{"location":"phi_functions/#","page":"φₖ functions","title":"φₖ functions","text":"We now Taylor expand ce^(h-s)z about z=0:","category":"page"},{"location":"phi_functions/#","page":"φₖ functions","title":"φₖ functions","text":"beginequation\nce^(h-s)z =\nsum_i=0^n fracz^i(h-s)^ii +\nfracce^(h-s)zetazeta^n+1(h-s)^n+1(n+1)\nquad abszeta leq z\nendequation","category":"page"},{"location":"phi_functions/#","page":"φₖ functions","title":"φₖ functions","text":"With this, we now calculate the definite integral appearing in the definition of varphi_k:","category":"page"},{"location":"phi_functions/#","page":"φₖ functions","title":"φₖ functions","text":"beginequation\nbeginaligned\nint_0^hdiffs\nce^(h-s)z s^k-1\n=\nint_0^hdiffs\nsum_i=0^n fracz^i(h-s)^is^k-1i +\nint_0^hdiffs\nfracce^(h-s)zetazeta^n+1(h-s)^n+1s^k-1(n+1) \n=\nsum_i=0^n\nfracz^ii\nint_0^hdiffs\n(h-s)^is^k-1 +\nint_0^hdiffs\nfracce^(h-s)zetazeta^n+1(h-s)^n+1s^k-1(n+1)\nendaligned\nendequation","category":"page"},{"location":"phi_functions/#","page":"φₖ functions","title":"φₖ functions","text":"For the case we are interested in, h=1 and the first integral is equivalent to Euler's beta function:","category":"page"},{"location":"phi_functions/#","page":"φₖ functions","title":"φₖ functions","text":"beginequation\nint_0^1diffs s^k-1(1-s)^i equiv Beta(ki+1) equiv fracGamma(k)Gamma(i+1)Gamma(k+i+1)\nendequation","category":"page"},{"location":"phi_functions/#","page":"φₖ functions","title":"φₖ functions","text":"which, for integer ki has the following value","category":"page"},{"location":"phi_functions/#","page":"φₖ functions","title":"φₖ functions","text":"beginequation\nBeta(ki+1) = frac(k-1)i(k+i)\nendequation","category":"page"},{"location":"phi_functions/#","page":"φₖ functions","title":"φₖ functions","text":"Inserting this into the integral (having set h=1), we find","category":"page"},{"location":"phi_functions/#","page":"φₖ functions","title":"φₖ functions","text":"beginequation\nlabeleqnphi-k-expansion\nvarphi_k(z) =\nsum_i=0^n\nfracz^i(k+i)\n+int_0^1diffs R_n(szeta)\nendequation","category":"page"},{"location":"phi_functions/#","page":"φₖ functions","title":"φₖ functions","text":"where we have made explicit the dependence of the Lagrange remainder R_n(szeta) on s.","category":"page"},{"location":"phi_functions/#","page":"φₖ functions","title":"φₖ functions","text":"Some numerical testing seems to indicate it is enough to set n=k in the Taylor expansion eqrefeqnphi-k-expansion to get accurate evaluation of phi_k(x) for small absx, xinmathbbR. For general z, the amount of required terms seems higher, so n is currently set to 10k.","category":"page"},{"location":"phi_functions/#","page":"φₖ functions","title":"φₖ functions","text":"(Image: Illustration of φ₁ accuracy)","category":"page"},{"location":"phi_functions/#","page":"φₖ functions","title":"φₖ functions","text":"The plot includes phi_k(z) for kin0100.","category":"page"},{"location":"phi_functions/#Reference-1","page":"φₖ functions","title":"Reference","text":"","category":"section"},{"location":"phi_functions/#","page":"φₖ functions","title":"φₖ functions","text":"MatrixPolynomials.φ₁\nMatrixPolynomials.φ","category":"page"},{"location":"phi_functions/#MatrixPolynomials.φ₁","page":"φₖ functions","title":"MatrixPolynomials.φ₁","text":"φ₁(z)\n\nSpecial case of φ for k=1, taking care to avoid numerical rounding errors for small z.\n\n\n\n\n\n","category":"function"},{"location":"phi_functions/#MatrixPolynomials.φ","page":"φₖ functions","title":"MatrixPolynomials.φ","text":"φ(k, z)\n\nCompute the entire function varphi_k(z), zinmathbbC, which is recursively defined as [Eq. (2.11) of Hochbruck2010]\n\nvarphi_k+1(z) equiv fracvarphi_k(z)-varphi_k(0)z\n\nwith the base cases\n\nvarphi_0(z) = exp(z) quad\nvarphi_1(z) = fracexp(z)-1z\n\nand the special case\n\nvarphi_k(0) = frac1k\n\nThis function, as the base case φ₁, is implemented to avoid rounding errors for small z.\n\n\n\n\n\n","category":"function"},{"location":"newton_polynomials/#Newton-polynomials-1","page":"Newton polynomials","title":"Newton polynomials","text":"","category":"section"},{"location":"newton_polynomials/#","page":"Newton polynomials","title":"Newton polynomials","text":"MatrixPolynomials.NewtonPolynomial\nMatrixPolynomials.NewtonMatrixPolynomial","category":"page"},{"location":"newton_polynomials/#MatrixPolynomials.NewtonPolynomial","page":"Newton polynomials","title":"MatrixPolynomials.NewtonPolynomial","text":"NewtonPolynomial(ζ, d)\n\nThe unique interpolation polynomial of a function in its Newton form, i.e.\n\nf(z) approx p(z) = sum_j=1^m fzeta_1zeta_j prod_i=1^j-1(z - zeta_i)\n\nwhere ζ are the interpolation points and d[j]=f[ζ₁,...,ζⱼ] is the jth divided difference of the interpolated function f.\n\n\n\n\n\n","category":"type"},{"location":"#MatrixPolynomials.jl-1","page":"Home","title":"MatrixPolynomials.jl","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"","category":"page"}]
}
