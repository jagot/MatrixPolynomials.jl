<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Functions of matrices · MatrixPolynomials.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/><script src="../assets/latex.js"></script></head><body><nav class="toc"><h1>MatrixPolynomials.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li class="current"><a class="toctext" href>Functions of matrices</a><ul class="internal"><li><a class="toctext" href="#Spectral-ranges-and-shapes-1">Spectral ranges and shapes</a></li></ul></li><li><a class="toctext" href="../leja/">Leja points</a></li><li><a class="toctext" href="../divided_differences/">Divided differences</a></li><li><a class="toctext" href="../newton_polynomials/">Newton polynomials</a></li><li><a class="toctext" href="../phi_functions/">φₖ functions</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Functions of matrices</a></li></ul><a class="edit-page" href="https://github.com/jagot/MatrixPolynomials.jl/blob/master/docs/src/funcv.md#L"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Functions of matrices</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Functions-of-matrices-1" href="#Functions-of-matrices-1">Functions of matrices</a></h1><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MatrixPolynomials.FuncV" href="#MatrixPolynomials.FuncV"><code>MatrixPolynomials.FuncV</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">FuncV{f,T}(s⁻¹Amc, c, s)</code></pre><p>Structure for applying the action of a polynomial approximation of the function <code>f</code> with a matrix argument acting on a vector, i.e. <code>w ← p(A)*v</code> where <code>p(z) ≈ f(z)</code>. Various properties of <code>f</code> may be used, such as shifting and scaling of the argument, to improve convergence and/or accuracy. <code>s⁻¹Amc</code> is the shifted linear operator <span>$s⁻¹(A-c)$</span>, <code>c</code> and <code>s</code> are the shift and scaling, respectively.</p></div></div><a class="source-link" target="_blank" href="https://github.com/jagot/MatrixPolynomials.jl/blob/8f28d013977533a54c4b0054fab998c82fb122f0/src/funcv.jl#LL1-L10">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MatrixPolynomials.FuncV" href="#MatrixPolynomials.FuncV"><code>MatrixPolynomials.FuncV</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">FuncV(f, A, m[, t=1; distribution=:leja, kwargs...])</code></pre><p>Create a <a href="#MatrixPolynomials.FuncV"><code>FuncV</code></a> that is used to compute <code>f(t*A)*v</code> using a polynomial approximation of <code>f</code> formed using <code>m</code> interpolation points.</p><p><code>kwargs...</code> are passed on to <a href="#MatrixPolynomials.spectral_range"><code>spectral_range</code></a> which estimates the range over which <code>f</code> has to be interpolated.</p></div></div><a class="source-link" target="_blank" href="https://github.com/jagot/MatrixPolynomials.jl/blob/8f28d013977533a54c4b0054fab998c82fb122f0/src/funcv.jl#LL32-L40">source</a></section><h2><a class="nav-anchor" id="Spectral-ranges-and-shapes-1" href="#Spectral-ranges-and-shapes-1">Spectral ranges and shapes</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MatrixPolynomials.spectral_range" href="#MatrixPolynomials.spectral_range"><code>MatrixPolynomials.spectral_range</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">spectral_range(A[; ctol=√ε, verbosity=0])</code></pre><p>Estimate the spectral range of the matrix/linear operator <code>A</code> using <a href="https://github.com/haampie/ArnoldiMethod.jl">ArnoldiMethod.jl</a>, with <code>ctol</code> setting the tolerance for the Krylov iterations. Returns a spectral <a href="#MatrixPolynomials.Shape"><code>Shape</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; A = Diagonal(1.0:6)
6×6 Diagonal{Float64,StepRangeLen{Float64,Base.TwicePrecision{Float64},Base.TwicePrecision{Float64}}}:
 1.0   ⋅    ⋅    ⋅    ⋅    ⋅
  ⋅   2.0   ⋅    ⋅    ⋅    ⋅
  ⋅    ⋅   3.0   ⋅    ⋅    ⋅
  ⋅    ⋅    ⋅   4.0   ⋅    ⋅
  ⋅    ⋅    ⋅    ⋅   5.0   ⋅
  ⋅    ⋅    ⋅    ⋅    ⋅   6.0

julia&gt; MatrixPolynomials.spectral_range(A, verbosity=2)
Converged: 1 of 1 eigenvalues in 6 matrix-vector products
Converged: 1 of 1 eigenvalues in 6 matrix-vector products
Converged: 1 of 1 eigenvalues in 6 matrix-vector products
Converged: 1 of 1 eigenvalues in 6 matrix-vector products
[ Info: Imaginary extent of spectral range 0.0 below tolerance 1.4901161193847656e-8, conflating.
[ Info: 0.0 below tolerance 1.4901161193847656e-8, truncating.
[ Info: 0.0 below tolerance 1.4901161193847656e-8, truncating.
MatrixPolynomials.Line{Float64}(0.9999999999999998 + 0.0im, 6.0 + 0.0im)

julia&gt; MatrixPolynomials.spectral_range(exp(im*π/4)*A, verbosity=2)
Converged: 1 of 1 eigenvalues in 6 matrix-vector products
Converged: 1 of 1 eigenvalues in 6 matrix-vector products
Converged: 1 of 1 eigenvalues in 6 matrix-vector products
Converged: 1 of 1 eigenvalues in 6 matrix-vector products
MatrixPolynomials.Rectangle{Float64}(0.7071067811865468 + 0.7071067811865478im, 4.242640687119288 + 4.242640687119283im)</code></pre><p>The second example should also be a <a href="#MatrixPolynomials.Line"><code>Line</code></a>, but the algorithm is not yet clever enough.</p></div></div><a class="source-link" target="_blank" href="https://github.com/jagot/MatrixPolynomials.jl/blob/8f28d013977533a54c4b0054fab998c82fb122f0/src/spectral_ranges.jl#LL1-L40">source</a><div><div><pre><code class="language-none">spectral_range(t, A)</code></pre><p>Finds the spectral range of <code>t*A</code>; if <code>t</code> is a vector, find the largest such range.</p></div></div><a class="source-link" target="_blank" href="https://github.com/jagot/MatrixPolynomials.jl/blob/8f28d013977533a54c4b0054fab998c82fb122f0/src/spectral_ranges.jl#LL74-L79">source</a></section><h3><a class="nav-anchor" id="Shapes-1" href="#Shapes-1">Shapes</a></h3><p>The shapes in the complex plane are mainly used to generate suitable distributions of <a href="../leja/#Leja-points-1">Leja points</a>, which are in turn used to generate <a href="../newton_polynomials/#Newton-polynomials-1">Newton polynomials</a> that efficiently approximate various functions on the field-of-values of a matrix <span>$\mat{A}$</span> which is contained within the spectral shape.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MatrixPolynomials.Shape" href="#MatrixPolynomials.Shape"><code>MatrixPolynomials.Shape</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">Shape</code></pre><p>Abstract base type for different shapes in the complex plane encircling the spectra of linear operators.</p></div></div><a class="source-link" target="_blank" href="https://github.com/jagot/MatrixPolynomials.jl/blob/8f28d013977533a54c4b0054fab998c82fb122f0/src/spectral_shapes.jl#LL1-L6">source</a></section><h4><a class="nav-anchor" id="Lines-1" href="#Lines-1">Lines</a></h4><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MatrixPolynomials.Line" href="#MatrixPolynomials.Line"><code>MatrixPolynomials.Line</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">Line(a, b)</code></pre><p>For spectra falling on a line in the complex plane from <code>a</code> to <code>b</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/jagot/MatrixPolynomials.jl/blob/8f28d013977533a54c4b0054fab998c82fb122f0/src/spectral_shapes.jl#LL11-L15">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.:*-Tuple{Number,MatrixPolynomials.Line}" href="#Base.:*-Tuple{Number,MatrixPolynomials.Line}"><code>Base.:*</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">n * l::Line</code></pre><p>Scale the <a href="#MatrixPolynomials.Line"><code>Line</code></a> <code>l</code> by <code>n</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/jagot/MatrixPolynomials.jl/blob/8f28d013977533a54c4b0054fab998c82fb122f0/src/spectral_shapes.jl#LL25-L29">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.range-Tuple{MatrixPolynomials.Line,Any}" href="#Base.range-Tuple{MatrixPolynomials.Line,Any}"><code>Base.range</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">range(l::Line, n)</code></pre><p>Generate a uniform distribution of <code>n</code> values along the <a href="#MatrixPolynomials.Line"><code>Line</code></a> <code>l</code>. If the line is on the real axis, the resulting values will be real as well.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; range(MatrixPolynomials.Line(0, 1.0im), 5)
5-element LinRange{Complex{Float64}}:
 0.0+0.0im,0.0+0.25im,0.0+0.5im,0.0+0.75im,0.0+1.0im

julia&gt; range(MatrixPolynomials.Line(0, 1.0), 5)
0.0:0.25:1.0</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/jagot/MatrixPolynomials.jl/blob/8f28d013977533a54c4b0054fab998c82fb122f0/src/spectral_shapes.jl#LL33-L50">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Statistics.mean-Tuple{MatrixPolynomials.Line}" href="#Statistics.mean-Tuple{MatrixPolynomials.Line}"><code>Statistics.mean</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">mean(l::Line)</code></pre><p>Return the mean value along the <a href="#MatrixPolynomials.Line"><code>Line</code></a> <code>l</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/jagot/MatrixPolynomials.jl/blob/8f28d013977533a54c4b0054fab998c82fb122f0/src/spectral_shapes.jl#LL60-L64">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.union-Tuple{MatrixPolynomials.Line,MatrixPolynomials.Line}" href="#Base.union-Tuple{MatrixPolynomials.Line,MatrixPolynomials.Line}"><code>Base.union</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">a::Line ∪ b::Line</code></pre><p>Form the union of the <a href="#MatrixPolynomials.Line"><code>Line</code></a>s <code>a</code> and <code>b</code>, which need to be collinear.</p></div></div><a class="source-link" target="_blank" href="https://github.com/jagot/MatrixPolynomials.jl/blob/8f28d013977533a54c4b0054fab998c82fb122f0/src/spectral_shapes.jl#LL75-L80">source</a></section><h4><a class="nav-anchor" id="Rectangles-1" href="#Rectangles-1">Rectangles</a></h4><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MatrixPolynomials.Rectangle" href="#MatrixPolynomials.Rectangle"><code>MatrixPolynomials.Rectangle</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">Rectangle(a,b)</code></pre><p>For spectra falling within a rectangle in the complex plane with corners <code>a</code> and <code>b</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/jagot/MatrixPolynomials.jl/blob/8f28d013977533a54c4b0054fab998c82fb122f0/src/spectral_shapes.jl#LL109-L114">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.:*-Tuple{Number,MatrixPolynomials.Rectangle}" href="#Base.:*-Tuple{Number,MatrixPolynomials.Rectangle}"><code>Base.:*</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">n * r::Rectangle</code></pre><p>Scale the <a href="#MatrixPolynomials.Rectangle"><code>Rectangle</code></a> <code>r</code> by <code>n</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/jagot/MatrixPolynomials.jl/blob/8f28d013977533a54c4b0054fab998c82fb122f0/src/spectral_shapes.jl#LL124-L128">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.range-Tuple{MatrixPolynomials.Rectangle,Any}" href="#Base.range-Tuple{MatrixPolynomials.Rectangle,Any}"><code>Base.range</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">range(r::Rectangle, n)</code></pre><p>Generate a uniform distribution of <code>n</code> values along the diagonal of the <a href="#MatrixPolynomials.Rectangle"><code>Rectangle</code></a> <code>r</code>.</p><p>This assumes that the eigenvalues lie on the diagonal of the rectangle, i.e. that the spread is negligible. It would be more correct to instead generate samples along the sides of the rectangle, however, <a href="#MatrixPolynomials.spectral_range"><code>spectral_range</code></a> needs to be modified to correctly identify spectral ranges falling on a line that is not lying on the real or imaginary axis.</p></div></div><a class="source-link" target="_blank" href="https://github.com/jagot/MatrixPolynomials.jl/blob/8f28d013977533a54c4b0054fab998c82fb122f0/src/spectral_shapes.jl#LL132-L144">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Statistics.mean-Tuple{MatrixPolynomials.Rectangle}" href="#Statistics.mean-Tuple{MatrixPolynomials.Rectangle}"><code>Statistics.mean</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">mean(r::Rectangle)</code></pre><p>Return the middle value of the <a href="#MatrixPolynomials.Rectangle"><code>Rectangle</code></a> <code>r</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/jagot/MatrixPolynomials.jl/blob/8f28d013977533a54c4b0054fab998c82fb122f0/src/spectral_shapes.jl#LL147-L151">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.union-Tuple{MatrixPolynomials.Rectangle,MatrixPolynomials.Rectangle}" href="#Base.union-Tuple{MatrixPolynomials.Rectangle,MatrixPolynomials.Rectangle}"><code>Base.union</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">a::Rectangle ∪ b::Rectangle</code></pre><p>Find the smalling <a href="#MatrixPolynomials.Rectangle"><code>Rectangle</code></a> encompassing <code>a</code> and <code>b</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/jagot/MatrixPolynomials.jl/blob/8f28d013977533a54c4b0054fab998c82fb122f0/src/spectral_shapes.jl#LL157-L161">source</a></section><footer><hr/><a class="previous" href="../"><span class="direction">Previous</span><span class="title">Home</span></a><a class="next" href="../leja/"><span class="direction">Next</span><span class="title">Leja points</span></a></footer></article></body></html>
